<process name="Delt_Files" version="1.0" bpversion="5.0.10.0" narrative="" type="object" runmode="Exclusive" preferredid="07541069-8a77-4a11-92be-8d5521bf2fb8">
  <appdef>
    <element name="Application Root">
      <id>911d689f-79a4-4dd3-9892-99d6a23f1efd</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>41</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="59061405-6e2a-4663-8e52-8fdbe0500f94" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e09830a0-1609-4bf0-962f-beb87f3b4d06" type="Normal" published="True">
    <name>Delete_Files_Completed</name>
    <view>
      <camerax>0</camerax>
      <cameray>21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="84cc3bde-0c36-43b8-b5fb-8e9908eee554" type="Normal" published="True">
    <name>Delete_Files_MsraFiles</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f535ddde-071d-4d5f-a000-48a09eafa5d2" type="Normal" published="True">
    <name>Delete_Files_Processed</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1a0fd934-d5bf-449e-b40c-c13077adc8e8" type="Normal" published="True">
    <name>Delete_Files_Logs</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2bd45c7d-46af-4e30-afd2-0a7e73629c89" type="Normal" published="False">
    <name>Delete Directory</name>
    <view>
      <camerax>53</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="71e30a0a-7e61-46a6-b84f-5ca46edebd44" type="Normal" published="True">
    <name>Delete Old Folders</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="fb03b535-dc4d-4722-ab46-0a7bd596ef87" type="Normal" published="False">
    <name>Get Folders</name>
    <view>
      <camerax>90</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ff8c76f8-878d-427b-a7ab-0bfa95838e18" type="Normal" published="True">
    <name>Delete Sub Folders</name>
    <view>
      <camerax>43</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="3f174c11-5683-4717-9cda-cb325c49b8c1" name="Start" type="Start">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>fe105fa7-830c-41c9-bccf-00701e7c0773</onsuccess>
  </stage>
  <stage stageid="fe105fa7-830c-41c9-bccf-00701e7c0773" name="End" type="End">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="74bed191-ed3f-4be2-8231-5fe142e6f9a2" name="Stage1" type="ProcessInfo">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>Microsoft.VisualBasic</import>
      <import>System.IO</import>
      <import>System.Data</import>
      <import>System.Diagnostics</import>
      <import>System.XML</import>
      <import>system.text.regularexpressions</import>
      <import>System.Data.OleDB</import>
      <import>System.Collections.Generic</import>
    </imports>
    <language>visualbasic</language>
    <globalcode><![CDATA[]]></globalcode>
    <code><![CDATA[Public Function GetDataTable(ByVal ColumnNamesCSV As String, ByVal ColumnTypesCSV As String) As DataTable

	Dim objTable As DataTable
	Dim objColumn As DataColumn
	Dim aColumnNames As String() = ColumnNamesCSV.Split(",")
	Dim aColumnTypes As String() = ColumnTypesCSV.Split(",")

	Try
		objTable = New DataTable
		For i As Integer = 0 To aColumnNames.Length - 1
			objColumn = New DataColumn 
			objColumn.DataType = System.Type.GetType(aColumnTypes(i).Trim)
			objColumn.ColumnName = aColumnNames(i).Trim
			objTable.Columns.Add(objColumn)
		Next
		
	Catch e As Exception
		objTable = nothing	
	End Try

	Return objTable

End Function]]></code>
  </stage>
  <stage stageid="1c857a42-f2e7-46dc-b19b-a1ea29743bdc" name="Clean Up" type="SubSheetInfo">
    <subsheetid>59061405-6e2a-4663-8e52-8fdbe0500f94</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="74c4f5cf-9c4c-4816-987c-a102f0afc378" name="Start" type="Start">
    <subsheetid>59061405-6e2a-4663-8e52-8fdbe0500f94</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>099abe83-5849-4d07-ab10-2cf1ebad84e7</onsuccess>
  </stage>
  <stage stageid="099abe83-5849-4d07-ab10-2cf1ebad84e7" name="End" type="End">
    <subsheetid>59061405-6e2a-4663-8e52-8fdbe0500f94</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d0ed868f-5e97-491f-be91-abc5ee2c0b61" name="Delete_Files_Completed" type="SubSheetInfo">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="9b52d73f-352e-4987-bdf1-ed79549d8346" name="Start" type="Start">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>1b9e60ca-979d-4041-aef0-4add4a3a6d2f</onsuccess>
  </stage>
  <stage stageid="a3f72ed0-a7f6-4f0d-b207-d0b02baa50c6" name="End" type="End">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c263c779-6b5e-416d-8bd2-11b4c8ea6287" name="Note1" type="Note">
    <subsheetid>59061405-6e2a-4663-8e52-8fdbe0500f94</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="a2e8de82-4e12-4386-883d-65ea5ba54cca" name="Note2" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="1b9e60ca-979d-4041-aef0-4add4a3a6d2f" name="VB_Delete_Files" type="Code">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>a3f72ed0-a7f6-4f0d-b207-d0b02baa50c6</onsuccess>
    <code><![CDATA[Dim fso, f, f1, fc
	fso = CreateObject("Scripting.FileSystemObject")
		'f = fso.GetFolder("E:\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles")
		'aFiles = Directory.GetFiles(Folder)
		f = fso.GetFolder(Folder)
			fc = f.Files
				For Each f1 in fc
					If DateDiff("d", f1.DateLastModified, Now) > 10 Then f1.Delete
					
				Next]]></code>
  </stage>
  <stage stageid="fc3a2175-8c9d-45c0-b6b0-97cc768fc4b7" name="Delete_Files_MsraFiles" type="SubSheetInfo">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="dbd775bf-5f87-4ecb-9235-f60fcf9d5851" name="Start" type="Start">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>42a6e726-273e-467c-8988-6b40fa60465b</onsuccess>
  </stage>
  <stage stageid="4470ca22-55d0-4c71-84d0-9722661a1cf5" name="End" type="End">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2c51f21b-996f-4932-a86c-3512a4e26e32" name="Delete_Files_Processed" type="SubSheetInfo">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c32c0d5f-7028-4e0b-8012-adb2f4ccaad6" name="Start" type="Start">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>788f8c83-58ef-4b76-9957-5262878d43eb</onsuccess>
  </stage>
  <stage stageid="5bb4dbca-eac3-4886-b474-40e974769944" name="End" type="End">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="42a6e726-273e-467c-8988-6b40fa60465b" name="VB_Delete_Files1" type="Code">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <onsuccess>4470ca22-55d0-4c71-84d0-9722661a1cf5</onsuccess>
    <code><![CDATA[Dim fso, f, f1, fc
	fso = CreateObject("Scripting.FileSystemObject")
		'f = fso.GetFolder("E:\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles")
		'aFiles = Directory.GetFiles(Folder)
		f = fso.GetFolder(Folder)
			fc = f.Files
				For Each f1 in fc
					If DateDiff("d", f1.DateLastModified, Now) > 10 Then f1.Delete
					
				Next]]></code>
  </stage>
  <stage stageid="788f8c83-58ef-4b76-9957-5262878d43eb" name="VB_Delete_Files2" type="Code">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Mesg" stage="Message" />
    </outputs>
    <onsuccess>5bb4dbca-eac3-4886-b474-40e974769944</onsuccess>
    <code><![CDATA[Dim fso, f, f1, fc
	fso = CreateObject("Scripting.FileSystemObject")
		'f = fso.GetFolder("E:\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles")
		'aFiles = Directory.GetFiles(Folder)
		f = fso.GetFolder(Folder)
			fc = f.Files
				For Each f1 in fc
					If DateDiff("d", f1.DateLastModified, Now) > 10 Then f1.Delete
					
				Next]]></code>
  </stage>
  <stage stageid="f6080c2d-5393-4325-8fab-d4c355fc2e53" name="Delete_Files_Logs" type="SubSheetInfo">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7f472a68-6b95-4c4c-94e8-a5ee6d3ea8b3" name="Start" type="Start">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>abb4bdce-eeca-423b-9f5e-6d49a54dfea4</onsuccess>
  </stage>
  <stage stageid="38d2360f-55d7-44b5-93f2-b162701a72cc" name="End" type="End">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="abb4bdce-eeca-423b-9f5e-6d49a54dfea4" name="VB_Delete_Files3" type="Code">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Mesg" stage="Message" />
    </outputs>
    <onsuccess>38d2360f-55d7-44b5-93f2-b162701a72cc</onsuccess>
    <code><![CDATA[Dim fso, f, f1, fc
	fso = CreateObject("Scripting.FileSystemObject")
		'f = fso.GetFolder("E:\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles")
		'aFiles = Directory.GetFiles(Folder)
		f = fso.GetFolder(Folder)
			fc = f.Files
				For Each f1 in fc
					If DateDiff("d", f1.DateLastModified, Now) > 15 Then f1.Delete
					
				Next]]></code>
  </stage>
  <stage stageid="6e4f9773-ac73-4afb-bc25-f5521bcee61a" name="Folder" type="Data">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\temp\Blue Prism</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="296f9b5a-d40b-444a-96cc-19a4e57a58cc" name="Folder" type="Data">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\v-prga\Downloads\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9aa662fc-5252-40f3-9452-242db96da180" name="Message" type="Data">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <narrative>
    </narrative>
    <displayx>-165</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e517c18f-c998-46e5-9871-81779aaf6804" name="Success" type="Data">
    <subsheetid>e09830a0-1609-4bf0-962f-beb87f3b4d06</subsheetid>
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7ffe1e6d-b04f-41be-bef2-d1f3a38fde9f" name="Folder" type="Data">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\v-prga\Downloads\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a3c96ab9-f5ae-4300-8e76-cee5626347a1" name="Folder" type="Data">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\v-prga\Downloads\MSRATools\MS RAS Supporting Files\MSRA\MsraFiles</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dc2e9e65-f7d5-45a2-a688-be372d178125" name="Message" type="Data">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <narrative>
    </narrative>
    <displayx>-165</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eb744eda-4588-4fdf-8852-1a86d26a70d5" name="Success" type="Data">
    <subsheetid>84cc3bde-0c36-43b8-b5fb-8e9908eee554</subsheetid>
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9ea0a08e-835c-4e4d-baa7-bc079048f261" name="Message" type="Data">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <narrative>
    </narrative>
    <displayx>-165</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="de80f00e-0130-4774-a486-75a1d4bf9820" name="Success" type="Data">
    <subsheetid>f535ddde-071d-4d5f-a000-48a09eafa5d2</subsheetid>
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e6122c88-0fb1-4eb5-b54f-e327e1af996f" name="Message" type="Data">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <narrative>
    </narrative>
    <displayx>-165</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e81fd0a2-ecf3-4bf3-8e9a-8a6dad225b9d" name="Success" type="Data">
    <subsheetid>1a0fd934-d5bf-449e-b40c-c13077adc8e8</subsheetid>
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c1b07a32-a35d-40a8-926d-dcf39aa942fd" name="Delete Directory" type="SubSheetInfo">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="572b0302-09e1-45fa-b2fe-c86cb1311856" name="Start" type="Start">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>bd2fe4f0-7a00-4b3f-8fff-15f1bd5cc988</onsuccess>
  </stage>
  <stage stageid="13765360-1028-425c-89b3-7b6d28a9c135" name="End" type="End">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Error Message" />
    </outputs>
  </stage>
  <stage stageid="1c34871e-7443-4fd6-ae0c-137c1de7a3bc" name="Directory Path" type="Data">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>-75</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bd2fe4f0-7a00-4b3f-8fff-15f1bd5cc988" name="Delete Directory1" type="Code">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Directory Path" expr="[Directory Path]" />
      <input type="flag" name="Recursive" expr="[Recursive]" />
      <input type="flag" name="ErrorIfNotExists" expr="[Error If Not Exists]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Error Message" stage="Error Message" />
    </outputs>
    <onsuccess>13765360-1028-425c-89b3-7b6d28a9c135</onsuccess>
    <code><![CDATA[Try
   If Directory.Exists(Directory_Path) Then
        

		Dim SubDirectories As Boolean
		SubDirectories = False

		Dim SubdirectoryEntries As String() 
		SubdirectoryEntries = Directory.GetDirectories(Directory_Path)
		
		
		If SubdirectoryEntries.Length > 0 Then SubDirectories = True

		If SubDirectories And Not Recursive Then Throw New ApplicationException("Directory has sub directories and will not be deleted")

		Directory.Delete(Directory_Path, Recursive) 
   
Else
      If ErrorIfNotExists Then Throw New ApplicationException("Directory does not exist")
   End If

	Success = True


Catch UAEx as UnauthorizedAccessException
	Success = False
	Error_Message = "The caller does not have the required permission to delete this directory or sub directories"

Catch ANEx as ArgumentNullException
	Success = False
	Error_Message = "Please check Directory Path parameter is not null"

Catch AEx as ArgumentException
	Success = False
	Error_Message = "Please check Directory Path parameter is a valid string"

Catch PTLEx as PathTooLongException
	Success = False
	Error_Message = "The specified path, file name, or both exceed the system-defined maximum length. For example, on Windows-based platforms, paths must be less than 248 characters and file names must be less than 260 characters."

Catch Ex as Exception
	Success = False
	Error_Message = Ex.ToString()

End Try]]></code>
  </stage>
  <stage stageid="bcb420ed-44c1-48f1-834e-6a078973ccd1" name="Success" type="Data">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>-15</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7643be31-adee-4b50-8ab7-d60684b539ce" name="Error Message" type="Data">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>360</displayx>
    <displayy>0</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e8873d39-4af6-4e29-a6f4-89a2d130cc9e" name="Recursive" type="Data">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>270</displayx>
    <displayy>-75</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="05b2e784-dffd-4425-a828-e6f4cc65e213" name="Error If Not Exists" type="Data">
    <subsheetid>2bd45c7d-46af-4e30-afd2-0a7e73629c89</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>-75</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="51b1bc6c-5af5-41c0-8f85-a04308d91b45" name="Delete Old Folders" type="SubSheetInfo">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="a861ddc5-284f-4b4c-b5eb-bb5a1643da0d" name="Start" type="Start">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="sDirectory" stage="sDirectory" />
    </inputs>
    <onsuccess>1016406e-9090-4a24-b2b1-ed02d21ca01c</onsuccess>
  </stage>
  <stage stageid="c2f898c6-fe04-4b86-9901-288c5ade2d8f" name="End" type="End">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Mesg" stage="Message" />
      <output type="flag" name="Success" stage="Success" />
    </outputs>
  </stage>
  <stage stageid="1016406e-9090-4a24-b2b1-ed02d21ca01c" name="Delete Old Folders" type="Code">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="sDirectory" expr="[sDirectory]" />
    </inputs>
    <outputs>
      <output type="text" name="Message" stage="Message" />
      <output type="flag" name="Success" stage="Success" />
    </outputs>
    <onsuccess>c2f898c6-fe04-4b86-9901-288c5ade2d8f</onsuccess>
    <code><![CDATA[Try
    Dim dtCreated As DateTime
    Dim dtToday As DateTime = Today.Date
    Dim diObj As DirectoryInfo
    Dim ts As TimeSpan
    Dim lstDirsToDelete As New List(Of String)

    For Each sSubDir As String In Directory.GetDirectories(sDirectory)
		diObj = New DirectoryInfo(sSubDir)
		dtCreated = diObj.CreationTime

		ts = dtToday - dtCreated

    'Add whatever storing you want here for all folders...

		If ts.Days > 10 Then
			lstDirsToDelete.Add(sSubDir)
		'Store whatever values you want here... like how old the folder is
			diObj.Delete(True) 'True for recursive deleting
		End If
    Success = True
    Next
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try]]></code>
  </stage>
  <stage stageid="eb0209af-5205-44d7-ab8e-551e405f9634" name="sDirectory" type="Data">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="68d0a911-71e2-46a7-9373-74ebe4357c6a" name="Message" type="Data">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-210</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="375ce849-8baf-4cc6-a1b9-a35e9ac089d3" name="Success" type="Data">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="926db9c0-cd03-4929-a9b0-77a329af0dfc" name="Note3" type="Note">
    <subsheetid>71e30a0a-7e61-46a6-b84f-5ca46edebd44</subsheetid>
    <loginhibit />
    <narrative>Try
    Dim dtCreated As DateTime
    Dim dtToday As DateTime = Today.Date
    Dim diObj As DirectoryInfo
    Dim ts As TimeSpan
	Dim st As TimeSpan
    Dim lstDirsToDelete As New List(Of String)

    For Each sSubDir As String In Directory.GetDirectories(sDirectory)
        diObj = New DirectoryInfo(sSubDir)
        dtCreated = diObj.CreationTime

        ts = dtToday - dtCreated
		Console.Writeline(ts)
		st = ts
        'Add whatever storing you want here for all folders...

        If ts.Days &gt; 10 Then
            lstDirsToDelete.Add(sSubDir)
            'Store whatever values you want here... like how old the folder is
            diObj.Delete(True) 'True for recursive deleting
        End If
    Next
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try</narrative>
    <displayx>-300</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="4c7683cf-0c78-4ffa-b97f-d8dd79ebb718" name="Get Folders" type="SubSheetInfo">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d711f06e-4064-4eb1-9f7c-483fca838f81" name="Start" type="Start">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>cd490397-7d15-46d3-aba3-2bb0325a02ab</onsuccess>
  </stage>
  <stage stageid="cd490397-7d15-46d3-aba3-2bb0325a02ab" name="Get Folders1" type="Code">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <outputs>
      <output type="collection" name="Folders" stage="Folders" />
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>d6af9bb8-ef54-4969-acc8-e396ee277d77</onsuccess>
    <code><![CDATA[
Dim objTable As DataTable
Dim objRow As DataRow
Dim aFolders As DirectoryInfo()
Dim oDirectory As New DirectoryInfo(Folder)

Try

	'Create a data table to output as a collection
	objTable = GetDataTable( _
		"Path," _
		& "Name," _
		& "Created," _
		& "Last Accessed," _
		& "Last Written", _
		"System.String," _
		& "System.String," _
		& "System.DateTime," _
		& "System.DateTime," _
		& "System.DateTime")
		
	aFolders = oDirectory.GetDirectories()
	For each oFolder as DirectoryInfo in aFolders
		objRow = objTable.NewRow()
		objRow("Path") = oFolder.FullName
		objRow("Name") = oFolder.Name
		objRow("Created") = oFolder.CreationTime
		objRow("Last Accessed") = oFolder.LastAccessTime
		objRow("Last Written") = oFolder.LastWriteTime

		objTable.Rows.Add(objRow)
	Next

	Folders = objTable
	Success = True
	Message = ""
Catch e As Exception
	Success = False
	Message = e.Message
End Try]]></code>
  </stage>
  <stage stageid="e22412d2-5631-46ca-8e70-237bb5c14762" name="Folder" type="Data">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="710bcdcb-5db7-4364-88c2-d39ffa64b2f4" name="Folders" type="Collection">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>90</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c3d59b36-548b-49cc-8863-b609f9f11f06" name="End" type="End">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Message" />
      <output type="collection" name="Folders" narrative="A collection of the sub-folders found within the folder" stage="Folders" />
    </outputs>
  </stage>
  <stage stageid="9105e932-fdf9-4007-8de3-e461e83452f5" name="Success" type="Data">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>150</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d7a51bd7-db55-489a-89cf-96dc5cc96ad5" name="Message" type="Data">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>180</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d6af9bb8-ef54-4969-acc8-e396ee277d77" name="Raise Exception If Appropriate" type="SubSheet">
    <subsheetid>fb03b535-dc4d-4722-ab46-0a7bd596ef87</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" />
      <input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" />
    </inputs>
    <onsuccess>c3d59b36-548b-49cc-8863-b609f9f11f06</onsuccess>
    <processid>8043916d-2ef9-45b8-ab66-f4c20ef1b8e3</processid>
  </stage>
  <stage stageid="e2964d17-dddb-4389-81e0-798e5fce69c7" name="Delete Sub Folders" type="SubSheetInfo">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="49ebfeee-21cf-4728-be36-bcd05140c693" name="Start" type="Start">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" stage="Folder" />
    </inputs>
    <onsuccess>dc922c2e-a10f-49aa-8113-b010a7e12531</onsuccess>
  </stage>
  <stage stageid="4f3f65f7-7ba3-4798-bc7f-242c1800f24b" name="End" type="End">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Mesg" stage="Message" />
      <output type="flag" name="Success" stage="Success" />
    </outputs>
  </stage>
  <stage stageid="dc922c2e-a10f-49aa-8113-b010a7e12531" name="Delete Old Folders1" type="Code">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Folder" expr="[Folder]" />
    </inputs>
    <outputs>
      <output type="text" name="Message" stage="Message" />
      <output type="flag" name="Success" stage="Success" />
    </outputs>
    <onsuccess>4f3f65f7-7ba3-4798-bc7f-242c1800f24b</onsuccess>
    <code><![CDATA[Try
	Dim dtCreated As DateTime
    Dim dtToday As DateTime = Today.Date
    Dim d As Object
    Dim ts As TimeSpan
	
	ts = dtToday - dtCreated

	If ts.Days > 10 Then
		For Each d in Directory.GetDirectories(Folder)
			Directory.Delete(d, true)
		Next
	End IF	
	
	' Finish removing also the files in the root folder
	'For Each f In Directory.GetFiles(Folder) 
		'If ts.Days > 10 Then
			'File.Delete(f)
		'End IF
	'Next
	Success = True

Catch ex As Exception
	Success = False
	Message = ex.Message

End Try]]></code>
  </stage>
  <stage stageid="89a340e1-501a-4cd4-8093-f85ba531d9f9" name="Folder" type="Data">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\v-prga\Downloads\MSRATesting\delete files</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a50b668a-3853-4547-aa3e-e7942cf3637a" name="Message" type="Data">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <narrative>
    </narrative>
    <displayx>-210</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="475bfd63-4a15-4c0c-9a83-7cd48a6b519a" name="Success" type="Data">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f90336df-78ba-467a-81b8-b5d482b4b6b9" name="Note3" type="Note">
    <subsheetid>ff8c76f8-878d-427b-a7ab-0bfa95838e18</subsheetid>
    <loginhibit />
    <narrative>Try
    Dim dtCreated As DateTime
    Dim dtToday As DateTime = Today.Date
    Dim diObj As DirectoryInfo
    Dim ts As TimeSpan
    Dim lstDirsToDelete As New List(Of String)

    For Each sSubDir As String In Directory.GetDirectories(sDirectory)
        diObj = New DirectoryInfo(sSubDir)
        dtCreated = diObj.CreationTime

        ts = dtToday - dtCreated

        'Add whatever storing you want here for all folders...

        If ts.Days &gt; 10 Then
            lstDirsToDelete.Add(sSubDir)
            'Store whatever values you want here... like how old the folder is
            diObj.Delete(True) 'True for recursive deleting
        End If
    Next
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try</narrative>
    <displayx>-345</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
</process>